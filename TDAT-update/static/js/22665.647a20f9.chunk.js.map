{"version":3,"file":"static/js/22665.647a20f9.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/sources/WFSSourceWorker.js","../node_modules/@arcgis/core/layers/graphics/sources/support/sourceUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{createTask as e}from\"../../../core/asyncUtils.js\";import t from\"../../../core/Error.js\";import r from\"../../../core/Logger.js\";import{throwIfAborted as a,isAbortError as s}from\"../../../core/promiseUtils.js\";import o from\"../../../core/Warning.js\";import{equals as n}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as i,convertToGeometry as u}from\"../featureConversionUtils.js\";import l from\"../data/FeatureStore.js\";import{checkProjectionSupport as h,project as c}from\"../data/projectionSupport.js\";import{QueryEngine as m}from\"../data/QueryEngine.js\";import{validateGeoJSON as p,createOptimizedFeatures as d}from\"./geojson/geojson.js\";import{mixAttributes as g}from\"./support/sourceUtils.js\";import{getGetFeatureSpatialReference as f,getFeatureCount as y,getFeature as _}from\"../../ogc/wfsUtils.js\";import x from\"../../support/FieldsIndex.js\";import{utc as C}from\"../../../time/timeZoneUtils.js\";const w=\"esri.layers.WFSLayer\";class R{constructor(){this._customParameters=null,this._queryEngine=null,this._supportsPagination=!0}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(e,r={}){const{getFeatureUrl:s,getFeatureOutputFormat:o,fields:n,geometryType:i,featureType:u,maxRecordCount:c,maxTotalRecordCount:p,maxPageCount:d,objectIdField:g,customParameters:y}=e,{spatialReference:_,getFeatureSpatialReference:w}=f(s,u,e.spatialReference);try{await h(w,_)}catch{throw new t(\"unsupported-projection\",\"Projection not supported\",{inSpatialReference:w,outSpatialReference:_})}a(r),this._customParameters=y,this._featureType=u,this._fieldsIndex=x.fromLayerJSON({fields:n,dateFieldsTimeReference:n.some((e=>\"esriFieldTypeDate\"===e.type))?{timeZoneIANA:C}:null}),this._geometryType=i,this._getFeatureUrl=s,this._getFeatureOutputFormat=o,this._getFeatureSpatialReference=w,this._maxRecordCount=c,this._maxTotalRecordCount=p,this._maxPageCount=d,this._objectIdField=g,this._spatialReference=_;let R=await this._snapshotFeatures(r);if(R.errors.length>0&&(this._supportsPagination=!1,R=await this._snapshotFeatures(r),R.errors.length>0))throw R.errors[0];return this._queryEngine=new m({fieldsIndex:this._fieldsIndex,geometryType:i,hasM:!1,hasZ:!1,objectIdField:g,spatialReference:_,timeInfo:null,featureStore:new l({geometryType:i,hasM:!1,hasZ:!1})}),this._queryEngine.featureStore.addMany(R.features),{warnings:T(R),extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new t(\"wfs-source:editing-not-supported\",\"applyEdits() is not supported on WFSLayer\")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}async refresh(t){return this._customParameters=t.customParameters,this._maxRecordCount=t.maxRecordCount,this._maxTotalRecordCount=t.maxTotalRecordCount,this._maxPageCount=t.maxPageCount,this._snapshotTask?.abort(),this._snapshotTask=e((e=>this._snapshotFeatures({signal:e}))),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),this._queryEngine.featureStore.addMany(e.features);for(const t of T(e))r.getLogger(w).warn(new o(\"wfs-layer:refresh-warning\",t.message,t.details));e.errors?.length&&r.getLogger(w).warn(new o(\"wfs-layer:refresh-error\",\"Refresh completed with errors\",{errors:e.errors}))}),(()=>{this._queryEngine.featureStore.clear()})),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures(e){const t=e?.signal,r=this._maxTotalRecordCount,o=this._maxPageCount,n=this._supportsPagination?await y(this._getFeatureUrl,this._featureType.typeName,{customParameters:this._customParameters,signal:t}):void 0;let i=[];const u=[];if(null==n)try{i=await this._singleQuery(t)}catch(l){s(l)||u.push(l)}else{const e=Math.min(n,r),a=F(this,Math.max(1,Math.min(Math.ceil(e/this._maxRecordCount),o)),t);await Promise.allSettled(Array.from({length:10}).map((()=>S(a,i,u))))}return a(t),{features:i,totalRecordCount:n,maxTotalRecordCount:r,maxPageCount:o,errors:u}}async _singleQuery(e){const t=await _(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,signal:e});return this._processGeoJSON(t,{signal:e})}async _pageQuery(e,t){const r=e*this._maxRecordCount,a=await _(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,startIndex:r,count:this._maxRecordCount,signal:t});return this._processGeoJSON(a,{startIndex:r,signal:t})}_processGeoJSON(e,t){p(e,this._getFeatureSpatialReference.wkid);const{startIndex:r,signal:s}=t;a(s);const o=d(e,{geometryType:this._geometryType,hasZ:!1,objectIdField:this._objectIdField});if(!n(this._spatialReference,this._getFeatureSpatialReference))for(const a of o)null!=a.geometry&&(a.geometry=i(c(u(a.geometry,this._geometryType,!1,!1),this._getFeatureSpatialReference,this._spatialReference)));let l=r??1;for(const a of o){const e={};g(this._fieldsIndex,e,a.attributes,!0),a.attributes=e,null==e[this._objectIdField]&&(a.objectId=e[this._objectIdField]=l++)}return o}}function*F(e,t,r){for(let a=0;a<t;a++)yield e._pageQuery(a,r)}async function S(e,t,r){let a=e.next();for(;!a.done;){try{const e=await a.value;t.push(...e)}catch(o){s(o)||r.push(o)}a=e.next()}}function T(e){const t=[];return null!=e.totalRecordCount&&(e.features.length<e.totalRecordCount&&t.push({name:\"wfs-layer:maxRecordCount-too-low\",message:`Could only fetch ${e.features.length} of ${e.totalRecordCount} in ${e.maxPageCount} queries. Try increasing the value of WFSLayer.maxRecordCount.`,details:{recordCount:e.features.length,totalRecordCount:e.totalRecordCount}}),e.totalRecordCount>e.maxTotalRecordCount&&t.push({name:\"wfs-layer:large-dataset\",message:`The number of ${e.totalRecordCount} features exceeds the maximum allowed of ${e.maxTotalRecordCount}.`,details:{recordCount:e.features.length,totalRecordCount:e.totalRecordCount,maxTotalRecordCount:e.maxTotalRecordCount}})),t}export{R as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{parseDate as t}from\"../../../../core/date.js\";import{isValid as n}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{validateFieldValue as e,validationErrorToString as r,isNumericField as i,isStringField as o,isDateField as s,sanitizeNullFieldValue as l}from\"../../../support/fieldUtils.js\";class u{constructor(){this.code=null,this.description=null}}class c{constructor(t){this.error=new u,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t}}function f(t){return new c(t)}class a{constructor(t){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}}function d(t){return new a(t)}const m=new Set;function p(t,n,i,o=!1){m.clear();for(const s in i){const l=t.get(s);if(!l)continue;const u=g(l,i[s]);if(m.add(l.name),l&&(o||l.editable)){const t=e(l,u);if(t)return f(r(t,l,u));n[l.name]=u}}for(const e of t.requiredFields??[])if(!m.has(e.name))return f(`missing required field \"${e.name}\"`);return null}function g(n,e){let r=e;return i(n)&&\"string\"==typeof e?r=parseFloat(e):o(n)&&null!=e&&\"string\"!=typeof e?r=String(e):s(n)&&\"string\"==typeof e&&(r=t(e)),l(r)}let h;function y(t,e){if(!t||!n(e))return t;if(\"rings\"in t||\"paths\"in t){if(null==h)throw new TypeError(\"geometry engine not loaded\");return h.simplify(e,t)}return t}async function w(){return null==h&&(h=await import(\"../../../../geometry/geometryEngineJSON.js\")),h}async function j(t,e){!n(t)||\"esriGeometryPolygon\"!==e&&\"esriGeometryPolyline\"!==e||await w()}export{f as createFeatureEditErrorResult,d as createFeatureEditSuccessResult,j as loadGeometryEngineForSimplify,p as mixAttributes,y as simplify};\n"],"names":["w","R","constructor","this","_customParameters","_queryEngine","_supportsPagination","destroy","load","e","r","arguments","length","undefined","getFeatureUrl","s","getFeatureOutputFormat","o","fields","n","geometryType","i","featureType","u","maxRecordCount","c","maxTotalRecordCount","p","maxPageCount","d","objectIdField","g","customParameters","y","spatialReference","_","getFeatureSpatialReference","f","h","t","inSpatialReference","outSpatialReference","a","_featureType","_fieldsIndex","x","fromLayerJSON","dateFieldsTimeReference","some","type","timeZoneIANA","C","_geometryType","_getFeatureUrl","_getFeatureOutputFormat","_getFeatureSpatialReference","_maxRecordCount","_maxTotalRecordCount","_maxPageCount","_objectIdField","_spatialReference","_snapshotFeatures","errors","m","fieldsIndex","hasM","hasZ","timeInfo","featureStore","l","addMany","features","warnings","T","extent","fetchRecomputedExtents","fullExtent","applyEdits","queryFeatures","_waitSnapshotComplete","executeQuery","signal","queryFeatureCount","executeQueryForCount","queryObjectIds","executeQueryForIds","queryExtent","executeQueryForExtent","querySnapping","executeQueryForSnapping","refresh","_snapshotTask","abort","promise","then","clear","getLogger","warn","message","details","finished","typeName","_singleQuery","push","Math","min","_pageQuery","F","max","ceil","Promise","allSettled","Array","from","map","async","next","done","value","S","totalRecordCount","_processGeoJSON","startIndex","count","wkid","geometry","attributes","objectId","name","recordCount","code","description","error","globalId","success","uniqueId","Set","get","add","editable","requiredFields","has","parseFloat","String","TypeError","simplify","j"],"sourceRoot":""}