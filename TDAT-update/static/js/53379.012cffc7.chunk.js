"use strict";(self.webpackChunkegis_tdat=self.webpackChunkegis_tdat||[]).push([[53379],{63733:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(35143),i=r(46053),o=(r(81806),r(76460),r(47249),r(85842)),s=r(5364),a=r(25515),p=r(65624),l=r(5682),u=r(64519),d=r(731);let y=class extends((0,p.dM)((0,l.j)(a.A))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new u.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,n._)([(0,i.MZ)({type:d.A})],y.prototype,"elevationInfo",void 0),(0,n._)([(0,i.MZ)((0,s.C)(u.Y,"graphics"))],y.prototype,"graphics",void 0),(0,n._)([(0,i.MZ)({type:["show","hide"]})],y.prototype,"listMode",void 0),(0,n._)([(0,i.MZ)()],y.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,i.MZ)({readOnly:!0})],y.prototype,"type",void 0),(0,n._)([(0,i.MZ)({constructOnly:!0})],y.prototype,"internal",void 0),y=(0,n._)([(0,o.$)("esri.layers.GraphicsLayer")],y);const c=y},40296:(e,t,r)=>{r.d(t,{F0:()=>p,Vx:()=>d,e2:()=>c,f:()=>h});var n=r(81806),i=r(53084),o=r(8298),s=r(16981),a=r(44460);function p(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?a.Cb:"esriGeometryPolyline"===e?a.yM:a.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let u=1;function d(e,t){if((0,n.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let r=`this${y(t)} = null;`;for(const t in e)r+=`this${y(t)} = ${JSON.stringify(e[t])};`;const n=new Function(`\n      return class AttributesClass$${u++} {\n        constructor() {\n          ${r};\n        }\n      }\n    `)();return()=>new n}catch(r){return()=>({[t]:null,...e})}}function y(e){return l.test(e)?`.${e}`:`["${e}"]`}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,i.o8)(e)}}]}function h(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:o.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:s.$,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},12718:(e,t,r)=>{r.d(t,{P:()=>_});var n=r(35143),i=(r(35238),r(91967)),o=r(50076),s=r(76460),a=r(87663),p=r(34154),l=r(46053),u=(r(81806),r(47249),r(85842)),d=r(65215),y=r(26346),c=r(80963),h=r(2948),m=r(33750),f=r(52451),g=r(88739),T=r(35380),b=r(68295),w=r(76797);let _=class extends i.A{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach((r=>{r.name&&(t.set(r.name,"entity"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(r.name),r.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(r.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.knowledgeGraph.dataModel.relationshipTypes?.forEach((r=>{r.name&&(t.set(r.name,"relationship"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(r.name),r.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(r.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((r,n)=>{if("entity"===t.get(n))this.entityTypeNames.add(n);else{if("relationship"!==t.get(n))return s.A.getLogger(this).warn(`A named type, ${n}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(n);this.relationshipTypeNames.add(n)}const i=new Map;r.members?.forEach((e=>{(0,a.tE)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(n);const t=this.getById(e.id);t&&i.set(e.id,t)})),this.sublayerCaches.set(n,i)}))}addToLayer(e){e.forEach((e=>{let{typeName:t,id:r}=e;if(!this.inclusionModeDefinition)throw new o.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const e=this.inclusionModeDefinition.namedTypeDefinitions.get(t);e.members||(e.members=new Map),e.members.set(r,{id:r}),(0,a.tE)(this.memberIdTypeLookup,r,(()=>new Set)).add(t)}}else{const e=new Map;e.set(r,{id:r}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:e}),(0,a.tE)(this.memberIdTypeLookup,r,(()=>new Set)).add(t)}}))}getById(e){return m.A.getInstance().readFromStoreById(e)}async getData(e,t,r){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let n;if(n=e||new b.default({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){const e=t.parentCompositeLayer,r=this._processingCacheUpdatesLookup.get(t.objectType.name??""),i=n.outFields;i&&1===i.length&&i[0]===h.dr&&"1=1"===n.where||await Promise.all(r??[]);const o=this.sublayerCaches.has(t.objectType.name??"")?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],s=[];return o.forEach((r=>{if(this.relationshipTypeNames.has(t.objectType.name)){r.geometry=e.relationshipLinkChartDiagramLookup.get(r.attributes[t.objectIdField]);const n=this.memberIdTypeLookup.get(r.attributes[h.Cz]),i=this.memberIdTypeLookup.get(r.attributes[h.KQ]),o=this._isEndEntitySpatial(n,r,h.Cz),s=this._isEndEntitySpatial(i,r,h.KQ);r.attributes[h.BL]=Number(o&&s)}else{r.geometry=e.entityLinkChartDiagramLookup.get(r.attributes[t.objectIdField]);const n=this.geographicLookup.get(t.objectType.name);n&&r.attributes[n.name]?r.attributes[h.BL]=1:r.attributes[h.BL]=0}r.attributes[h.T1]=r.geometry,s.push(r)})),s}return this.retrieveDataFromService(n,t,r)}async getConnectedRecordIds(e,t){const r=[];let n="";const i=[],o=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e)){if(!this.entityTypeNames.has(t))return;o.has(t)?o.get(t)?.push(e):o.set(t,[e])}})),t&&0!==t?.length){for(const e of t)n=n+e+"|";n=n.slice(0,-1)}const a={};let p="",l=-1;for(const[s,d]of o){l++,0!==l&&(p+=" UNION ");const e=`${s}_ids`;a[e]=d,p+=t&&0!==t?.length?`MATCH (n:${s}) WHERE id(n) IN $${e} WITH n MATCH (n)-[r:${n}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${s}) WHERE id(n) IN $${e} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`}if(!p)return r;const u=new Promise((e=>{(async()=>{const e=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,new T.A({openCypherQuery:p,bindParameters:a}))).resultRowsStream.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;for(let e=0;e<n.length;e++){const t=n[e];r.push({id:t[0],typeName:t[1]}),r.push({id:t[2],typeName:t[3]})}}}catch(t){if("AbortError"!==t.name)throw t;s.A.getLogger(this).info("Request aborted as expected")}})().then((()=>{e()}))}));return i.push(u),this.refreshCacheContent(),await Promise.all(i),r}async getRelationshipsBetweenNodes(e,t){const r=[],n=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,new T.A({openCypherQuery:"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await n.read();if(e)break;for(let n=0;n<t.length;n++){const e=t[n];r.push({id:e[0],typeName:e[1]})}}}catch(i){if("AbortError"!==i.name)throw i;s.A.getLogger(this).info("Request aborted as expected")}return r}async getRelationshipsFromNodes(e,t,r){const n=[],i=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,new T.A({openCypherQuery:"MATCH (n)-[r]-(m) WHERE id(n) IN $targetEntityIds AND id(m) in $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{targetEntityIds:e,possibleConnectionEntityIds:t,relationshipExclusionIds:r}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await i.read();if(e)break;for(let r=0;r<t.length;r++){const e=t[r];n.push({id:e[0],typeName:e[1]})}}}catch(o){if("AbortError"!==o.name)throw o;s.A.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=m.A.getInstance(),s=[],p=new Map,l=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&l.set(e.name,e)})),this.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&l.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e))p.has(t)?p.get(t)?.push(e):p.set(t,[e])})):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e.useAllData?p.set(t,null):e.members&&e.members.forEach((e=>{p.has(t)&&null!==p.get(t)?p.get(t)?.push(e.id):p.set(t,[e.id])}))})):(this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&p.set(e.name,null)})),this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&p.set(e.name,null)})));for(const[u,d]of p){const e=new Promise((e=>{(async()=>{const e=new Set,s=[];let p,y="",c=!1;if(t||l.get(u)?.properties?.forEach((t=>{t.name&&e.add(t.name)})),r&&this.geographicLookup.has(u)){const t=this.geographicLookup.get(u)?.name;t&&e.add(t)}if(this.entityTypeNames.has(u))y=`MATCH (n:${u}) ${d?"WHERE id(n) IN $ids ":""}return ID(n)`,e.forEach((e=>{y+=`, n.${e}`,s.push(e)}));else{if(!this.relationshipTypeNames.has(u))throw new o.A("knowledge-graph:layer-data-manager",`The graph type of ${u} could not be determined. Was this type set in the KG data model and inclusion definition?`);c=!0,y=`MATCH ()-[n:${u}]->() ${d?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,e.forEach((e=>{y+=`, n.${e}`,s.push(e)}))}p=new T.A(d?{openCypherQuery:y,bindParameters:{ids:d}}:{openCypherQuery:y});const m=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,p)).resultRowsStream.getReader();for(;;){const{done:e,value:t}=await m.read();if(e)break;const r=[];for(let n=0;n<t.length;n++){const e=t[n];let i=0,o=0;const p={properties:{}};for(p.id=e[i],i++,o++,c&&(p.originId=e[i],i++,o++,p.destinationId=e[i],i++,o++,(0,a.tE)(this.nodeConnectionsLookup,p.originId,(()=>new Set)).add(p.id),(0,a.tE)(this.nodeConnectionsLookup,p.destinationId,(()=>new Set)).add(p.id),(0,a.tE)(this.relationshipConnectionsLookup,p.id,(()=>[p.originId,p.destinationId])));i<e.length;i++)p.properties[s[i-o]]=e[i];r.push(p)}const o=i.writeToStore(r,h.dr,this.geographicLookup.get(u)?.name);this.sublayerCaches.has(u)||this.sublayerCaches.set(u,new Map),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(u)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(u,{useAllData:!1,members:new Map}),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(u).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(u).members=new Map);const p=this.sublayerCaches.get(u);o.forEach((e=>{p?.set(e.attributes[h.dr],e),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(u).members.has(e.attributes[h.dr])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(u).members.set(e.attributes[h.dr],{id:e.attributes[h.dr]}),(0,a.tE)(this.memberIdTypeLookup,e.attributes[h.dr],(()=>new Set)).add(u))}))}})().then((()=>{e(null)}))}));s.push(e),this._processingCacheUpdatesLookup.get(u)?.push(e)}await Promise.all(s)}removeFromLayer(e){const t=new Set,r=new Set(e.map((e=>e.id)));for(const n of e)t.add(n.typeName),1===this.memberIdTypeLookup.get(n.id)?.size?this.memberIdTypeLookup.delete(n.id):this.memberIdTypeLookup.get(n.id)?.delete(n.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach(((e,t)=>{t===n.typeName&&e.members?.has(n.id)&&e.members.delete(n.id)}));t.forEach((e=>{this.sublayerCaches.get(e)?.forEach(((t,n)=>{r.has(n)&&this.sublayerCaches.get(e)?.delete(n)}))}))}async retrieveDataFromService(e,t,r){const n=m.A.getInstance(),i=new Set,s=[];let a,l="",u=[];const b="relationship"===t.graphType,_=this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData,E=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let M=!_&&E?Array.from(E).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData&&null!=e.objectIds&&(M=e.objectIds);else if(null!=e.objectIds&&M&&M.length>0){const t=e.objectIds;e.objectIds=M.filter((e=>t.includes(e)))}else if(null!=e.objectIds)M=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(t.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=M}if(null!=e.outFields){const r=e.outFields;r.includes("*")?t.fields.forEach((e=>{i.add(e.name)})):r.forEach((e=>{e!==h.dr&&e!==t.geometryFieldName&&i.add(e)}))}if(null!=e.geometry){const r=e.geometry;let n;const u=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,h=u?.spatialReference,m=u?.serviceCapabilities?.geometryCapabilities;let g=m?.geometryMaxBoundingRectangleSizeX,_=m?.geometryMaxBoundingRectangleSizeY;if("point"===r.type){let e=r;e.spatialReference?.isWGS84||(await(0,y.initializeProjection)(e.spatialReference,c.KK),e=(0,y.project)(e,c.KK)),n=new w.A({spatialReference:c.KK,xmin:e.x-1e-4,ymin:e.y-1e-4,xmax:e.x+1e-4,ymax:e.y+1e-4})}else r?.extent?.spatialReference&&!r.spatialReference?.isWGS84?(await(0,y.initializeProjection)(r.extent.spatialReference,c.KK),n=(0,y.project)(r.extent,c.KK)):n=r.extent;if(g&&_&&h){if(4326!==h.wkid){const e=new w.A({spatialReference:h,xmax:g,ymax:_}),t=(0,y.project)(e,c.KK);g=t.xmax,_=t.ymax}if(n.xmax-n.xmin>g)throw new o.A("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${g}\xb0 latitude, limit exceeded`);if(n.ymax-n.ymin>_)throw new o.A("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${_}\xb0 longitude, limit exceeded`)}if(null!=e.where&&"1=1"!==e.where){const r=await(0,p.G)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{r.fieldNames.includes(e.name)&&i.add(e.name)}))}l=b?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{l+=`, n.${e}`,s.push(e)})),a=new T.A({openCypherQuery:l,bindParameters:{param_filter_geom:new d.A({rings:(0,f.DX)(n)})}})}else{let r="";if(null!=e.where&&"1=1"!==e.where){const n=await(0,p.G)(e.where,t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&i.add(e.name)}));const o=new Set(["column-reference","string","number","binary-expression"]),s=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let a=!1;const l=e=>{if("column-reference"===e.type)return`n.${e.column}`;if("string"===e.type)return`'${e.value}'`;if("number"===e.type)return`${e.value}`;if("binary-expression"===e.type&&o.has(e.left.type)&&o.has(e.right.type)&&s.has(e.operator))return`${l(e.left)} ${e.operator} ${l(e.right)}`;if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+=`lower(n.${e.left.args.value[0].column})`;else{if("column-reference"!==e.left.type)return a=!0,"";t+=`lower(n.${e.left.column})`}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let r=e.right.value;"%"===r.charAt(0)&&(r=r.slice(1)),"%"===r.charAt(r.length-1)&&(r=r.slice(0,-1)),t+=`'${r.toLowerCase()}')`}return t}return a=!0,""};r=l(n.parseTree),a&&(r="")}let n="";n=b?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let o=!1;M&&(o=!0,n+=" WHERE ID(n) IN $ids"),r&&(n+=o?" AND":" WHERE",n+=` ${r}`),n+=" return ID(n)",b&&(n+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{n+=`, n.${e}`,s.push(e)})),a=new T.A(M?{openCypherQuery:n,bindParameters:{ids:M}}:{openCypherQuery:n})}const I=(await(0,g.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,a,r)).resultRowsStream.getReader();for(;;){const{done:e,value:r}=await I.read();if(e)break;const i=[];for(let t=0;t<r.length;t++){const e=r[t];let n=0,o=0;const a={properties:{}};for(a.id=e[n],n++,o++,b&&(a.originId=e[n],n++,o++,a.destinationId=e[n],n++,o++);n<e.length;n++)a.properties[s[n-o]]=e[n];i.push(a)}u=u.concat(n.writeToStore(i,h.dr,t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name)?.name))}return u}_isEndEntitySpatial(e,t,r){for(const n of e??[])if(this.entityTypeNames.has(n)){const e=this.geographicLookup.get(n),i=e&&this.sublayerCaches.get(n)?.get(t.attributes[r]);if(e&&i?.attributes[e.name])return!0}return!1}};(0,n._)([(0,l.MZ)()],_.prototype,"knowledgeGraph",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"inclusionModeDefinition",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"entityTypeNames",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"relationshipTypeNames",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"geographicLookup",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"sublayerCaches",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"nodeConnectionsLookup",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"relationshipConnectionsLookup",void 0),(0,n._)([(0,l.MZ)()],_.prototype,"memberIdTypeLookup",void 0),_=(0,n._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],_)},83716:(e,t,r)=>{r.d(t,{A:()=>W});var n=r(35143),i=(r(35238),r(16868)),o=(r(63844),r(14873),r(47662),r(72690),r(17122),r(71832),r(5766),r(35039),r(86616)),s=r(31382),a=r(53084),p=r(77717),l=(r(16783),r(46053)),u=(r(81806),r(76460),r(85842)),d=r(17707),y=r(49140),c=r(26346),h=r(13312),m=r(80963),f=r(25515),g=r(72547),T=r(55301),b=r(40296);r(47249);const w=(0,r(76350).p)(),_=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,n._)([(0,l.MZ)(w.fields)],t.prototype,"fields",void 0),(0,n._)([(0,l.MZ)(w.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,n._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};var E=r(2948),M=r(65624),I=r(74440),v=r(52908),A=r(37534),S=r(21617),N=r(5682),D=r(78817),L=r(95363),C=r(54490),R=r(44135),k=r(53430),x=r(71401),O=r(27937),F=r(83982),j=r(77725),Z=r(68295),q=r(30973),G=r(59989),$=r(76797),B=r(65215),P=r(23701),Q=r(19247),U=r(31608);function H(e){if(!e.json)return e;e.json.write=z(e.json.write);const t=e.json.origins;if(!t)return e;let r;for(r in t){const e=t[r];e&&(e.write=z(e.write))}return e}function z(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){const{target:t,writer:r,overridePolicy:n,...i}=e;return function(e,t){const r=V.call(this,e,t);return r.enabled?{...i,...r}:r}}(e)),e):!0===e?J():e}function J(){return{overridePolicy:V}}function V(e,t){const r=!!this.geometryType;let n={enabled:r};return r&&(n={...n,...K.call(this,e,t)}),n}function K(e,t){return{ignoreOrigin:this.originIdOf(t)>y.Gr.DEFAULTS}}let Y=class extends(_((0,v.J)((0,I.F)((0,M.dM)((0,A.f)((0,D.e)((0,N.j)((0,S.J)((0,p.P)(f.A)))))))))){constructor(e){var t;super(e),t=this,this.blendMode="normal",this.capabilities=(0,b.f)(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=E.dr,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new G.A(e.port1,{channel:e,client:{queryFeatures:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Z.default.fromJSON(e);return t.queryFeaturesJSON(n,r)}}}),[e.port2]}))},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){const e=[];return this.objectType?.properties?.forEach((t=>{const r="esriFieldTypeOID"===t.fieldType?"esriFieldTypeInteger":t.fieldType;e.push(R.default.fromJSON({name:t.name,type:r,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))})),e.push(R.default.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),R.default.fromJSON({name:E.M1,type:"esriFieldTypeInteger",alias:E.M1,editable:!1}),R.default.fromJSON({name:E.BL,type:"esriFieldTypeInteger",alias:E.BL,editable:!1})),e}get geometryType(){if("link-chart"===this.parentCompositeLayer?.type)return"relationship"===this.graphType?"polyline":"point";const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&"esriGeometryNull"!==t?U.g.fromJSON(t):null}get geometryFieldName(){if("link-chart"===this.parentCompositeLayer?.type)return E.T1;const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name);return e?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,r=t?this.objectType?.properties?.[t]:null;return r?.hasM??!1}get hasZ(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,r=t?this.objectType?.properties?.[t]:null;return r?.hasZ??!1}set renderer(e){(0,k.fixRendererFields)(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){return this._isOverridden("renderer")?this._get("renderer"):"link-chart"===this.parentCompositeLayer?.type?"relationship"===this.graphType?(0,o.fromJSON)((0,b.F0)(U.g.toJSON("polyline")).renderer):(0,o.fromJSON)((0,b.F0)(U.g.toJSON("point")).renderer):(0,o.fromJSON)((0,b.F0)(U.g.toJSON(this.geometryType)).renderer)}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??h.A.WGS84}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return(0,q.tn)(this,e)}createQuery(){return new Z.default({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:r,queryEngine:n}=await this._setupQueryObjects(e),i=j.default.fromJSON(await n.executeQuery(r.toJSON(),t?.signal));return i.features.forEach((e=>{e.sourceLayer=this})),i}async queryFeaturesJSON(e,t){const{resolvedQuery:r,queryEngine:n}=await this._setupQueryObjects(e);return await n.executeQuery(r.toJSON(),t?.signal)}async queryFeatureCount(e,t){const{resolvedQuery:r,queryEngine:n}=await this._setupQueryObjects(e);return n.executeQueryForCount(r.toJSON(),t?.signal)}async queryExtent(){let e=arguments.length>1?arguments[1]:void 0;const t={...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},returnGeometry:!0},{resolvedQuery:r,queryEngine:n}=await this._setupQueryObjects(t),i=await n.executeQueryForExtent(r.toJSON(),e?.signal);let o;return o=null!=i.extent?.xmin&&null!=i.extent?.xmax&&null!=i.extent?.ymin&&null!=i.extent?.ymax?new $.A(i.extent):new $.A,{count:i.count,extent:o}}async queryObjectIds(e,t){const r=Z.default.from(e);let n;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(r,this,t);n=this.loadQueryEngine(e)}return n.executeQueryForIds(r.toJSON(),t?.signal)}loadQueryEngine(e){const t=new g.A({geometryType:U.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),r=new T.d({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:U.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:this.timeInfo?.toJSON(),featureStore:t});return r.featureStore.addMany(e),r}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new Z.default({where:"1=1",outFields:[E.dr]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then((()=>{(0,k.fixTimeInfoFields)(this.timeInfo,this.fieldsIndex)}))),Promise.resolve(this)}async _setupQueryObjects(e,t){const r=Z.default.from(e),n=r.geometry;let i;if(n&&!n.spatialReference?.isWGS84&&(await(0,c.initializeProjection)(n.spatialReference,m.KK),r.geometry=(0,c.project)(n instanceof B.A||n instanceof P.A||n instanceof Q.A?n:n.extent,m.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)i=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(r,this,t);i=this.loadQueryEngine(e)}return{resolvedQuery:r,queryEngine:i}}};(0,n._)([(0,l.MZ)(H((0,a.o8)(M.sU)))],Y.prototype,"blendMode",void 0),(0,n._)([(0,l.MZ)()],Y.prototype,"capabilities",void 0),(0,n._)([(0,l.MZ)({json:{origins:{"web-scene":{write:!1}},write:J()}})],Y.prototype,"charts",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],Y.prototype,"defaultPopupTemplate",null),(0,n._)([(0,l.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],Y.prototype,"definitionExpression",void 0),(0,n._)([(0,l.MZ)()],Y.prototype,"displayField",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(M.LF)))],Y.prototype,"effect",void 0),(0,n._)([(0,l.MZ)()],Y.prototype,"elevationInfo",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(I.Y)))],Y.prototype,"featureEffect",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(C.d)))],Y.prototype,"featureReduction",null),(0,n._)([(0,l.MZ)()],Y.prototype,"fields",null),(0,n._)([(0,l.MZ)()],Y.prototype,"geometryType",null),(0,n._)([(0,l.MZ)()],Y.prototype,"geometryFieldName",null),(0,n._)([(0,l.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],Y.prototype,"graphType",void 0),(0,n._)([(0,l.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],Y.prototype,"graphTypeName",null),(0,n._)([(0,l.MZ)()],Y.prototype,"hasM",null),(0,n._)([(0,l.MZ)()],Y.prototype,"hasZ",null),(0,n._)([(0,l.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],Y.prototype,"id",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(L.kF)))],Y.prototype,"labelsVisible",void 0),(0,n._)([(0,l.MZ)({type:[x.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:O.w,write:J()}})],Y.prototype,"labelingInfo",void 0),(0,n._)([(0,l.MZ)({readOnly:!0,json:{read:!1,write:{writer(e,t){switch(this.parentCompositeLayer.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],Y.prototype,"layerType",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(L.fV)))],Y.prototype,"legendEnabled",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(L.hG)))],Y.prototype,"maxScale",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(L.hn)))],Y.prototype,"minScale",void 0),(0,n._)([(0,l.MZ)()],Y.prototype,"objectIdField",void 0),(0,n._)([(0,l.MZ)()],Y.prototype,"objectType",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(L.ke)))],Y.prototype,"opacity",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(A.n)))],Y.prototype,"orderBy",void 0),(0,n._)([(0,l.MZ)({clonable:!1})],Y.prototype,"parent",void 0),(0,n._)([(0,l.MZ)()],Y.prototype,"parentCompositeLayer",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(L.M6)))],Y.prototype,"popupEnabled",void 0),(0,n._)([(0,l.MZ)({type:i.A,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],Y.prototype,"popupTemplate",void 0),(0,n._)([(0,l.MZ)({type:Number,json:{write:{overridePolicy:K}}})],Y.prototype,"refreshInterval",void 0),(0,n._)([(0,l.MZ)({types:s.H,json:{name:"layerDefinition.drawingInfo.renderer",write:J()}})],Y.prototype,"renderer",null),(0,n._)([(0,l.MZ)()],Y.prototype,"source",void 0),(0,n._)([(0,l.MZ)()],Y.prototype,"spatialReference",null),(0,n._)([(0,l.MZ)({type:F.A,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],Y.prototype,"timeInfo",null),(0,n._)([(0,l.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],Y.prototype,"title",null),(0,n._)([(0,d.K)("title")],Y.prototype,"writeTitle",null),(0,n._)([(0,l.MZ)({json:{read:!1}})],Y.prototype,"type",void 0),(0,n._)([(0,l.MZ)(H((0,a.o8)(D.B)))],Y.prototype,"useViewTime",void 0),(0,n._)([(0,l.MZ)({type:Boolean,json:{name:"visibility",write:J()}})],Y.prototype,"visible",void 0),Y=(0,n._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],Y);const W=Y},33750:(e,t,r)=>{r.d(t,{A:()=>a});r(35238);var n=r(98618),i=r(20176),o=r(2948),s=r(19902);class a{constructor(){this._featureLookup=new Map}static getInstance(){return a.instance||(a.instance=new a),a.instance}static resetInstance(){a.instance&&(a.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const r=this.readFromStoreById(e);r&&t.push(r)})),t}readFromStoreById(e){return this._featureLookup.get(e)??null}writeToStore(e,t,r){const a=[];return e.forEach((e=>{if(!e?.id)return;e.properties||(e.properties=[]);let p,l=null;if(r&&e.properties[r]&&(l=(0,n.Ux)(e.properties[r])),"originId"in e&&"destinationId"in e&&(e.properties[o.Cz]=e.originId,e.properties[o.KQ]=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const n=this._featureLookup.get(e.id),o=JSON.parse(JSON.stringify(Object.assign(n.attributes,e.properties)));r&&e.properties[r]&&(o[r]=(0,s.fromJSON)(e.properties[r])),p=new i.Om(l?JSON.parse(JSON.stringify(l)):n?.geometry?JSON.parse(JSON.stringify(n.geometry)):null,o,null,e.properties[t])}else p=new i.Om(l?JSON.parse(JSON.stringify(l)):null,e.properties,null,e.properties[t]);this._featureLookup.set(`${e.typeName?`${e.typeName}__${e.id}`:e.id}`,p),a.push(p)})),a}}},2948:(e,t,r)=>{r.d(t,{BL:()=>l,Cz:()=>o,KQ:()=>s,M1:()=>p,T1:()=>a,dr:()=>i,qN:()=>y});var n=r(88739);const i="ESRI__ID",o="ESRI__OriginID",s="ESRI__DestID",a="ESRI__LayoutGeometry",p="ESRI__AggregationCount",l="LC.ESRI__IsSpatial",u={initializeLayersFromClientData:async(e,t)=>{if(t||(t=[...e.layers,...e.tables].map((e=>e.graphTypeName))),0===t?.length)return;const r=new Map;for(const n of t)r.set(n,d(e,n));const i=await(0,n.fetchClientDataAtKeys)(e.dataManager.knowledgeGraph,Array.from(r.values()));for(const n of[...e.layers,...e.tables]){const t=n.objectType.name;if(null===t)continue;const r=i.get(d(e,t));if(r){const e=JSON.parse(r);null===e||"object"!=typeof e||e.hasOwnProperty("showLabels")||(e.showLabels=!1),n.read(e,{origin:"service"})}}}},d=(e,t)=>"knowledge-graph"===e.type?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function y(e,t){return u.initializeLayersFromClientData(e,t)}},52451:(e,t,r)=>{r.d(t,{DX:()=>f,_s:()=>T,aq:()=>g,fe:()=>b});r(35238),r(39356);var n,i=r(3825),o=(r(95444),r(50076)),s=r(87663),a=(r(63733),r(98618),r(2948),r(33750),r(85646),r(88739)),p=r(35380);r(13312);!function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"}(n||(n={}));n.ELEMENTUID,n.TYPENAME;var l,u;!function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(l||(l={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(u||(u={}));var d,y,c,h,m=r(57502);r(31830);!function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(d||(d={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(y||(y={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(c||(c={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(h||(h={}));r(89465),r(23701),r(86875),r(65215),r(86659),r(19247);function f(e){if(!e.spatialReference.isWGS84)throw new o.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}async function g(e,t){const r=[],n=new Map,i=[];if(t.dataModel?.relationshipTypes)for(const o of t.dataModel.relationshipTypes)o.name&&n.set(o.name,[]);for(const o of e)n.has(o.typeName)&&n.get(o.typeName)?.push(o.id);for(const[o,s]of n){if(s.length<1)continue;const e=new p.A({openCypherQuery:`MATCH (n)-[r:${o}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:s}});i.push((0,a.executeQueryStreaming)(t,e).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:n}=await t.read();if(e)break;for(const t of n)r.push({id:t[0],typeName:t[1]}),r.push({id:t[2],typeName:t[3]})}})))}return await Promise.all(i),r}async function T(e,t){t??=!1;const r={generateAllSublayers:t,namedTypeDefinitions:new Map};return await w(e).then((e=>{_(e,r)})),r}async function b(e){const t=await(0,m.I)(),r=new t.MapOfObjectIdentifierSets;!function(e,t,r){for(const[n,i]of r.namedTypeDefinitions){if(!i.members||i.useAllData)continue;const r=i.members.keys();let o=!1,s=!0;const a=new t.ObjectIdArray,p=new t.StringArray,l=new t.GlobalIdArray,u=new t.IdentifierArray,d=new t.ObjectIdentifierSet;for(const e of r)s&&(o=!isNaN(Number(e)),s=!1),o?a.add_objectid(Number(e)):(p.add_string(e),l.add_globalid(e)),u.add_identifier(e);d.set_oid_array(a),d.set_string_array(p),d.set_globalid_array(l),d.set_identifier_array(u),a.delete(),p.delete(),l.delete(),u.delete(),e.put_identifier_set(n,d),d.delete()}}(r,t,e);const n=new t.MapOfObjectIdentifierSetsEncoder;try{n.set_map_of_identifier_sets(r),n.encode();const e=n.get_encoding_result();if(0!==e.error.error_code)throw new o.A("knowledge-graph:layer-support-utils",e.error.error_message);const t=structuredClone(e.get_byte_buffer());return n.delete(),t}finally{r.delete()}}async function w(e){const t=await(0,i.default)(e,{responseType:"array-buffer"}),r=await t.data;return async function(e){const t=new((await(0,m.I)()).MapOfObjectIdentifierSetsDecoder),r=t.decode(new Uint8Array(e)),n=new Map;if(0!==r.error_code)throw new o.A("knowledge-graph:layer-support-utils",r.error_message);const i=t.get_map_of_identifier_sets(),s=i.keys,a=s.size();for(let p=0;p<a;p++){const e=s.get(p),t=i.query_identifier_set(e),r=[];if(t.id_array_type.value===h.GLOBALID_ARRAY){const e=t.get_globalid_array(),n=e.count();for(let t=0;t<n;t++)r.push(e.get_globalid_at(t))}else if(t.id_array_type.value===h.IDENTIFIER_ARRAY){const e=t.get_identifier_array(),n=e.count();for(let t=0;t<n;t++)r.push(e.get_identifier_at(t).toString())}else if(t.id_array_type.value===h.STRING_ARRAY){const e=t.get_string_array(),n=e.count();for(let t=0;t<n;t++)r.push(e.get_string_at(t))}else{if(t.id_array_type.value!==h.OID_ARRAY)throw new o.A("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const e=t.get_oid_array(),n=e.count();for(let t=0;t<n;t++)r.push(e.get_objectid_at(t).toString())}}n.set(e,r)}return t.delete(),n}(new Uint8Array(r))}function _(e,t){for(const[r,n]of e){const e=(0,s.tE)(t.namedTypeDefinitions,r,(()=>({useAllData:!1,members:new Map})));for(const t of n)e.members.has(t)||e.members.set(t,{id:t})}return t}},16981:(e,t,r)=>{r.d(t,{$:()=>n,P:()=>i});const n={supportsDate:!1,supportsFixedInterval:!1,supportsAutoInterval:!1,supportsFixedBoundaries:!1,supportedStatistics:void 0},i={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:n,query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},85646:(e,t,r)=>{r.d(t,{$C:()=>f,Hh:()=>s,J:()=>p,Tu:()=>h,Wg:()=>m,Xq:()=>T,i6:()=>b,pM:()=>c,tx:()=>a,vJ:()=>g});var n=r(28899);let i,o=null;function s(){return i||(i=r.e(83884).then(r.bind(r,83884)).then((e=>e.l)).then((e=>{let{default:t}=e;return t({locateFile:e=>(0,n.s)(`esri/libs/linkchartlayout/${e}`)})})).then((e=>{!function(e){o=e}(e)})),i)}var a,p,l,u;function d(e){const t=Object.keys(l).filter((e=>isNaN(parseInt(e,10)))).indexOf(e.timeDirection),r=Object.keys(u).filter((e=>isNaN(parseInt(e,10)))).indexOf(e.eventsTicksVisualization);return{timeDirection:{value:t>-1?t:l.right},timeBannerUTCOffsetInMinutes:e.timeBannerUTCOffsetInMinutes,eventsTicksVisualization:{value:r>-1?r:u.startAndEnd},showDurationLineForNonZeroDurationEntityEvents:e.showDurationLineForNonZeroDurationEntityEvents,durationLineWidth:e.durationLineWidth,entityPositionAtDurationRatio:e.entityPositionAtDurationRatio,showNonZeroDurationIntervalBounds:e.showNonZeroDurationIntervalBounds,separateTimeOverlaps:e.separateTimeOverlaps,separateTimelineOverlaps:e.separateTimelineOverlaps,moveFirstBends:e.moveFirstBends,secondBendRatio:e.secondBendRatio,lineSeparationMultiplier:e.lineSeparationMultiplier,spaceSeparatedLinesEvenly:e.spaceSeparatedLinesEvenly,useBezierCurves:e.useBezierCurves,separatedLineShapeRatio:e.separatedLineShapeRatio}}function y(e,t,r,n,i,s){const a=r.length,p=i.length,l=Float64Array.BYTES_PER_ELEMENT,u=Uint32Array.BYTES_PER_ELEMENT,d=Uint8Array.BYTES_PER_ELEMENT,y=16+a*(d+2*l)+p*(2*u),c=o._malloc(y);try{const d=c+16-c%16,y=d+a*l,h=y+a*l,m=h+p*u,f=m+p*u,g=()=>[o.HEAPF64.subarray(d>>3,(d>>3)+a),o.HEAPF64.subarray(y>>3,(y>>3)+a),o.HEAPU32.subarray(h>>2,(h>>2)+p),o.HEAPU32.subarray(m>>2,(m>>2)+p),o.HEAPU8.subarray(f,f+a)],[T,b,w,_,E]=g();T.set(r),b.set(n),w.set(i),_.set(s),E.set(t);let M=e(a,f,d,y,p,h,m),I=null,v=null;if(M){const e=o.getLayoutLinksTypes(),t=o.getLayoutLinksVerticesEndIndices(),r=o.getLayoutLinksVertices(),n=o.countLayoutLinksVertices();!p||e&&t?n&&!r?M=!1:(I={types:new Uint8Array(o.HEAPU8.subarray(e,e+p)),vertexEndIndex:new Uint32Array(o.HEAPU32.subarray(t>>2,(t>>2)+p)),vertices:new Float64Array(o.HEAPF64.subarray(r>>3,(r>>3)+2*n))},v=o.getAuxiliaryGraphicElements()):M=!1}const[A,S,N,D,L]=g();return r.set(A),n.set(S),i.set(N),s.set(D),t.set(L),{success:M,links:I,graphics:v}}finally{o._free(c),o.cleanupLayout()}}!function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot",e[e.IsOld=8]="IsOld"}(a||(a={})),function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(p||(p={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(l||(l={})),function(e){e[e.none=0]="none",e[e.startOnly=1]="startOnly",e[e.startAndEnd=2]="startAndEnd"}(u||(u={}));var c,h,m,f,g,T,b,w,_;!function(e){e.getMinIdealEdgeLength=function(){return o.getMinIdealEdgeLength()},e.apply=function(e,t,r,n,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,p=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1;return y(((e,t,r,n,i,l,u)=>o.applyForceDirectedLayout(e,t,r,n,i,l,u,s,a,p)),e,t,r,n,i)}}(c||(c={})),function(e){e.apply=function(e,t,r,n,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,p=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1;return y(((e,t,r,n,i,l,u)=>o.applyCommunityLayout(e,t,r,n,i,l,u,s,a,p)),e,t,r,n,i)}}(h||(h={})),function(e){e.apply=function(e,t,r,n,i){return y(o.applySimpleLayout,e,t,r,n,i)}}(m||(m={})),function(e){e.apply=function(e,t,r,n,i){return y(o.applyHierarchicalLayout,e,t,r,n,i)}}(f||(f={})),function(e){e.apply=function(e,t,r,n,i){return y(o.applyRadialTreeLayout,e,t,r,n,i)}}(g||(g={})),function(e){e.apply=function(e,t,r,n,i){return y(o.applySmartTreeLayout,e,t,r,n,i)}}(T||(T={})),function(e){e.apply=function(e,t,r,n,i,s,a,p,c,h,m){const f={timeDirection:l.right,timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:u.startAndEnd,showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0};return y(((e,t,r,s,a,l,u)=>{if(n.length!==e)return!1;if(i.length!==e)return!1;if(p.length!==a)return!1;if(c.length!==a)return!1;const y=Float64Array.BYTES_PER_ELEMENT,g=16,T=o._malloc(g+e*y),b=o._malloc(g+e*y),w=o._malloc(g+a*y),_=o._malloc(g+a*y),E=T+g-T%g,M=b+g-b%g,I=w+g-w%g,v=_+g-_%g;try{o.HEAPF64.subarray(E>>3,(E>>3)+e).set(n),o.HEAPF64.subarray(M>>3,(M>>3)+e).set(i),o.HEAPF64.subarray(I>>3,(I>>3)+a).set(p),o.HEAPF64.subarray(v>>3,(v>>3)+a).set(c);const y=d(Object.assign(f,m));return o.applyChronologicalLayout(e,t,r,s,E,M,a,l,u,I,v,h,y)}finally{o._free(T),o._free(b),o._free(w),o._free(_)}}),e,t,r,s,a)}}(b||(b={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(w||(w={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(_||(_={}))},9505:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(35143),i=(r(35238),r(46053)),o=(r(81806),r(76460),r(47249),r(85842)),s=r(27544),a=r(19247);let p=class extends s.A{constructor(e){super(e),this.layoutGeometry=null}};(0,n._)([(0,i.MZ)({type:a.A,json:{write:!0}})],p.prototype,"layoutGeometry",void 0),p=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.Entity")],p);const l=p},27544:(e,t,r)=>{r.d(t,{A:()=>p});var n=r(35143),i=r(46053),o=(r(81806),r(76460),r(47249),r(85842)),s=r(12831);let a=class extends s.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"typeName",void 0),(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"id",void 0),a=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.GraphNamedObject")],a);const p=a},12831:(e,t,r)=>{r.d(t,{A:()=>p});var n=r(35143),i=r(42553),o=r(46053),s=(r(81806),r(76460),r(47249),r(85842));let a=class extends i.oY{constructor(e){super(e),this.properties=null}};(0,n._)([(0,o.MZ)({json:{write:!0}})],a.prototype,"properties",void 0),a=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.GraphObject")],a);const p=a},35380:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(35143),i=r(46053),o=(r(81806),r(76460),r(47249),r(85842)),s=r(91967);let a=class extends s.A{constructor(e){super(e),this.openCypherQuery=""}};(0,n._)([(0,i.MZ)()],a.prototype,"openCypherQuery",void 0),a=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.GraphQuery")],a);const p=a;let l=class extends p{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,n._)([(0,i.MZ)()],l.prototype,"bindParameters",void 0),(0,n._)([(0,i.MZ)()],l.prototype,"bindGeometryQuantizationParameters",void 0),(0,n._)([(0,i.MZ)()],l.prototype,"outputQuantizationParameters",void 0),(0,n._)([(0,i.MZ)()],l.prototype,"outputSpatialReference",void 0),(0,n._)([(0,i.MZ)()],l.prototype,"provenanceBehavior",void 0),l=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],l);const u=l},38156:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(35143),i=(r(76460),r(81806),r(47249),r(50076),r(85842)),o=r(12831);let s=class extends o.A{constructor(e){super(e)}};s=(0,n._)([(0,i.$)("esri.rest.knowledgeGraph.ObjectValue")],s);const a=s},68325:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(35143),i=r(42553),o=r(46053),s=(r(81806),r(76460),r(47249),r(85842)),a=r(12831);let p=class extends i.oY{constructor(e){super(e),this.path=null}};(0,n._)([(0,o.MZ)({type:[a.A],json:{write:!0}})],p.prototype,"path",void 0),p=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.Path")],p);const l=p},23908:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(35143),i=(r(35238),r(46053)),o=(r(81806),r(76460),r(47249),r(85842)),s=r(27544),a=r(23701);let p=class extends s.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],p.prototype,"originId",void 0),(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],p.prototype,"destinationId",void 0),(0,n._)([(0,i.MZ)({type:a.A,json:{write:!0}})],p.prototype,"layoutGeometry",void 0),p=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.Relationship")],p);const l=p}}]);
//# sourceMappingURL=53379.012cffc7.chunk.js.map